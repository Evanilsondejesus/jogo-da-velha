<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <style>
#tabuleiro{
display: grid;
grid-template-columns: 50px 50px 50px;
grid-template-rows: 50px 50px 50px;
width: 400px;
margin: auto;

}
#resultado{
text-align: center;
color: brown;
display: block;

}





    </style>




<h1>Jogo da Velha</h1>

<div id="dv_jogador">
    <label for="">Nome do jogador:</label><br>

<input type="text" id="digite_nome" placeholder="seu nome...">    <br>
<input type="button" id="btn_salvar" value="salvar">

</div>









    Partidas:  <span id="partidas"> 0</span>   
    <br>

    <p>
    Maquina: <span id="maquina_pontos"> 0</span>   <br>
    <span id="nome_jogador"></span>:   <span id="jogador_pontos"> 0</span> <br>

</p> 
<pan id="resultado"></pan><br>



<div id="tabuleiro">

<button data-peca="1"></button>
<button data-peca="2"></button>
<button data-peca="3"></button>


<button data-peca="4"></button>
<button data-peca="5"></button>
<button data-peca="6"></button>


<button data-peca="7"></button>
<button data-peca="8"></button>
<button data-peca="9"></button>
</div>


<script>
  



btn_salvar.addEventListener("click", ()=>{

nome_jogador.innerText = digite_nome.value==""? alert("digite outro numero") :   dv_jogador.hidden = true         ;
nome_jogador.innerText = digite_nome.value;


  })





let positions = [
  [1, 2, 3],
  [4, 5, 6],
  [7, 8, 9],
  [1, 4, 7],
  [2, 5, 8],
  [3, 6, 9],
  [1, 5, 9],
  [3, 5, 7],
];


var maquina = [];
var jogador = [];   
var jogando = true; 






var pecas = document.querySelectorAll("button");   
var resultado = document.querySelector("#resultado");











function Init() {
maquina = [];
jogador = [];
jogando = true;



    for (let n = 0; n < pecas.length; n++) {
    
        pecas[n].innerText = "";
        pecas[n].style.color = "black";
        pecas[n].style.fontSize = "20px";


    pecas[n].addEventListener("click", Marca);
    
}














}






Init()





function Marca(e) {
 
if (digite_nome.value == "" || nome_jogador.innerText== "") { alert("digite e salve seu nome pra começa"); return }


var index = Number(e.target.getAttribute("data-peca"));

e.target.removeEventListener("click", Marca);
jogador.push(index) 

console.log("valor jogador: "+ index);



if (jogando==true)  e.target.innerText = "x"

 verificar();










}









function verificar() {
if (!(jogando)) {  return;}  


for (pot of positions) {
 
    if (pot.every( (item) => jogador.includes(item))) {
        resultado.innerText = "Jogador ganhou!!"
 



  for (let n = 0; n < pot.length; n++) {
    pecas[ (pot[n] - 1) ].style.color = "blue"
    pecas[(pot[n] -1)].style.fontSize = "30px"
    
    
  }




Number(partidas.innerText++)
Number(jogador_pontos.innerText++);


      jogando = false;




setTimeout(() => {
    







setTimeout(() => {
    resultado.innerText = "Jogo está iniciando..."
  
}, 500);


Init()


jogando = true;


}, 5000);











      return;
    }
 }

 


 Maquina()
 for (teste of positions) { 

 
 if (teste.every( (item) => maquina.includes(item))) {
resultado.innerText = "Maquina ganhou!!";


for (let n = 0; n < pot.length; n++) {
    pecas[ (teste[n] - 1) ].style.color = "blue"
    pecas[(teste[n] -1)].style.fontSize = "30px"
    
    
  }


Number(partidas.innerText++)
Number(maquina_pontos.innerText++);

 
//Init();








setTimeout(() => {
    







    setTimeout(() => {
        resultado.innerText = "Jogo está iniciando..."
      
    }, 500);
    
    
    Init()
    
    
    jogando = true;
    
    
    }, 5000);
    
    


















 
   return;
 }
 



}








}






function Maquina() {
    


        
    if ((maquina.length + jogador.length) < 8) {
        
        do {
         var   num = Math.floor(Math.random() * 9) + 1;
        
        
          } while (jogador.includes(num) || maquina.includes(num) );
           
        
          maquina.push(num);  
        pecas[(num -1)].innerText=  "0"; 
        console.log("gerado: "+ num)
        
    
    console.log("valor: "+ (maquina.length + jogador.length))
            
        }else{
    
            resultado.innerText = "Jogo de impate";
 



setTimeout(()=>{

    Number(partidas.innerText++)

setTimeout(() => {
    resultado.innerText = "Jogo está iniciando..."
  
}, 500);


Init()


jogando = true;


}, 5000);















        }
        
    

    }
    
    

 





</script>







</body>
</html>